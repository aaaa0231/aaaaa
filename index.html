<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>GitHub P2Pãƒãƒ«ãƒãƒãƒ£ãƒƒãƒˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: sans-serif; background: #f0f0f0; margin: 0; text-align: center; }
#chat { max-width: 600px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow:0 0 10px #ccc;}
#messages { height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; text-align:left; margin-bottom:10px;}
.msg { margin:5px 0; }
input, button, textarea { width:100%; padding:8px; margin:5px 0;}
</style>
</head>
<body>
<div id="chat">
<h2>ğŸŒ GitHub P2Pãƒãƒ«ãƒãƒãƒ£ãƒƒãƒˆ</h2>
<div id="messages"></div>
<input id="name" placeholder="åå‰ã‚’å…¥åŠ›">
<input id="text" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›">
<button id="send">é€ä¿¡</button>
<button id="voice">éŸ³å£°ON/OFF</button>
<hr>
<h3>ãƒ«ãƒ¼ãƒ æ¥ç¶š</h3>
<textarea id="signal" placeholder="ã“ã“ã«æ¥ç¶šãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚‹"></textarea>
<button id="copy">æ¥ç¶šãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼</button>
<button id="connect">æ¥ç¶š</button>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const room = params.get("room") || "default";
const messages = document.getElementById("messages");
let localName = "";
let pcList = {};
let channelList = {};
let localStream = null;

function log(msg, who="system") {
  const div = document.createElement("div");
  div.textContent = msg;
  div.className = "msg "+who;
  messages.appendChild(div);
  messages.scrollTop = 9999;
  // å±¥æ­´ä¿å­˜
  let history = JSON.parse(localStorage.getIt
